一.原理

二.实例

三.监控



Hystrix
容错保护
pom.xml添加
<dependency>
	<groupId>org.springframework.cloud</groupId>
	<artifactId>spring-cloud-starter-hystrix</artifactId>
</dependency>

ribbon_consumer实例
ConsumerController.java>helloConsumer0()与helloConsumer2

原理
高级配置

仪表盘(hystrix_dashboard)

三种不同的监控方式
1.默认集群监控
http://turbine-hostname:port/turbine.stream
2.指定的集群监控
http://turbine-hostname:port/turbine.stream?cluster=[clusterName]
3.单体应用的监控
http://hystrix-app:port/hystrix.stream

前两者需要turbine整合,单体服务实例监控步骤如下:

实例POM.xml加入(ribbon-consumer为例)
<dependency>
	<groupId>org.springframework.cloud</groupId>
	<artifactId>spring-cloud-starter-hystrix</artifactId>
</dependency>
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-actuator</artifactId>
</dependency>

确保实例主类加入@EnableCircuitBreaker注释

监控首页
http://127.0.0.1:2001/hystrix
把地址输入到仪表盘里面查看监控
http://localhost:9000/hystrix.stream
调用熔断保护url(调用后界面才显示图标参数)
http://127.0.0.1:9000/ribbon-consumer0
http://127.0.0.1:9000/ribbon-consumer2


Turbine集群监控(turbine)
启动eureka-server,hello-service,ribbon-consumer,turbine以及Hystrix dashboard
把地址输入到仪表盘里面查看监控
http://127.0.0.1:8989/turbine.stream


与消息代理结合(turbine_amqp)
对服务消费者RIBBON-CONSUMER添加
<dependency>
	<groupId>org.springframework.cloud</groupId>
	<artifactId>spring-cloud-netflix-hystrix-amqp</artifactId>
</dependency>

启动eureka-server,hello-service,ribbon-consumer,turbine以及Hystrix dashboard,同时确保rabbitmq启动
开启访问:
http://127.0.0.1:8989/turbine.stream